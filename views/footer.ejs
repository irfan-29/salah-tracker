    
    
    <% if (globalAudioUrl) { %>
      
      <style>
        .rotating-icon {
          width: 48px;
          height: 48px;
          border-radius: 50%;
          object-fit: cover;
          border: 2px solid #e0e0e0;
          padding: 1.5px;
          background: #fff;
        }
      
        .rotate {
          animation: spin 4s linear infinite;
        }
      
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        @media (max-width: 600px) {
          .audio-container {
            flex-wrap: wrap;
          }
      
          .close-mobile {
            position: absolute;
            top: 10px;
            right: 15px;
          }
    
      
          .audio-player {
            flex: 1 1 100%;
          }
        }
        
      </style>

      
        <div class="container1" style="position: fixed; bottom: 0; left: 0; right: 0; margin: 0 auto; width: 100%; background: #ffffff; border-top: 1px solid #ddd; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); padding: 12px; z-index: 100; text-align: left;">
          <div class="audio-container" style="display: flex; align-items: center; justify-content: space-between; margin: 0 auto; gap: 10px; padding: 10px 5px 0 5px;">
      
            <!-- Surah Info + Reciter -->
            <div style="display: flex; align-items: center; gap: 10px; flex: 1 1 auto; min-width: 100px; position: relative; bottom: 4px; left: 5px;">
              <img src="images/audio-player.webp" id="audioIcon" alt="Quran Audio" class="rotating-icon" />
              <div style="position: relative; left: 5px;">
                <div style="font-size: 14px; color: #444; font-weight: 500;"><%= globalSurahNo %>. <%= globalSurahName %></div>
                <div style="font-size: 13px; color: #888;"><%= globalFavoriteReciter %></div>
              </div>
              <div style="position: relative; left: 17px;">
                <img src="images/back.png" width="21px" style="margin-right: 8px;"/>
                <img src="images/next-button.png" width="21px"/>
              </div>
             
            </div>
      
            <!-- Audio Player -->
            <div class="audio-player" style="flex: 10 1 auto; min-width: 220px;">
              <audio id="globalAudio" controls style="width: 100%; height: 45px;">
                <source src="<%= globalAudioUrl %>" type="audio/mpeg" />
                Your browser does not support the audio element.
              </audio>
            </div>
      
            <!-- Close Button -->
            <form action="/hide-audio" method="POST" class="close-mobile" style="flex: 0 0 auto; margin: 0;">
              <button type="submit" style="background: none; border: none; font-size: 20px; cursor: pointer; color: #999;">âœ•</button>
            </form>
      
          </div>
        </div>
      <!-- </div> -->
      



      
      


      
      
    
      <script>
        const audio = document.getElementById('globalAudio');
        const savedTime = <%= JSON.stringify(globalAudioTime || 0) %>;
      
        if (audio) {
          let timeRestored = false;
      
          audio.addEventListener('loadedmetadata', () => {
            if (!timeRestored && !isNaN(savedTime)) {
              audio.currentTime = savedTime;
              timeRestored = true;
            }
          });
      
          // Play only after restoring time
          audio.addEventListener('canplaythrough', () => {
            if (timeRestored) {
              audio.play().catch(err => {
                console.error("Autoplay failed:", err);
              });
            }
          });
      
          // Periodically update playback time to server
          setInterval(() => {
            if (!audio.paused && !isNaN(audio.currentTime)) {
              fetch('/update-audio-time', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                  surahNo: "<%= globalSurahNo %>",
                  surahName: "<%= globalSurahName %>",
                  time: audio.currentTime
                })
              }).then(res => {
                if (!res.ok) {
                  console.error('Server error during time update');
                }
              }).catch(err => console.error('Fetch error:', err));
            }
          }, 5000);
        }


        document.addEventListener('DOMContentLoaded', () => {
          const audio = document.getElementById('globalAudio');
          const icon = document.getElementById('audioIcon');

          if (audio && icon) {
            audio.addEventListener('play', () => {
              icon.classList.add('rotate');
            });
          
            audio.addEventListener('pause', () => {
              icon.classList.remove('rotate');
            });
          
          }
        });
      

      </script>
      
    <% } %>
    
    















    
    
    

      
    

      
      
      
      


    
    
    
    <br>
    <br>
    
    
    
    </body>
</html>